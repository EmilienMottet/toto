<?xml version="1.0" encoding='UTF-8'?>
<Widget name="Standard Search Form" group="Search Forms">

	<Description>The CloudView standard search form with support for suggest.</Description>

	<Preview>
		<![CDATA[
			<img src="/resources/widgets/searchForm/images/preview.png" alt="Search Form" />
		]]>
	</Preview>

	<Dependencies>
		<Widget name="formInput" includeCondition="enableSuggest=true" /> <!-- Include jquery.suggest.js -->
		<Widget name="formForm" /> <!-- include all exa/ and searchAction.js -->
	</Dependencies>

	<Includes>
		<Include type="css" path="css/searchForm.less" />
	</Includes>

	<SupportWidgetsId arity="ZERO" />
	<SupportFeedsId arity="ZERO" />
	<SupportI18N supported="true" />
	
	<Interactions>
		<Interaction type="out" id="exa.io.FormInterface"></Interaction>
		<Interaction type="in" id="exa.io.GeoInterface">
			<Description>Restrict the search in this area</Description>
			<Option id="geoDataInputName" name="Input parameter" arity="ZERO_OR_ONE">
				<Description>Specifies the geographic Parameter Name associated with the input submitted for the entry box.</Description>
				<Functions>
					<ContextMenu>PageParameters()</ContextMenu>
					<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
				</Functions>
			</Option>
			<Option id="geoMetaName" name="Geographical index field" arity="ZERO_OR_ONE">
				<Description>Specifies the name of the geographic index field to search with.</Description>
				<Functions>
					<ContextMenu>Metas()</ContextMenu>
					<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
				</Functions>
			</Option>
		</Interaction>
	</Interactions>
	

	<OptionsGroup name="General">
		<Option id="inputName" name="Input parameter" arity="ONE">
			<Description>Specifies the Parameter Name associated with the input submitted for the entry box.</Description>
			<Functions>
				<ContextMenu>PageParameters()</ContextMenu>
				<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
			</Functions>
		</Option>
		<Option id="inputSize" name="Input size" arity="ONE">
			<Description>Specifies the width of the query input field.</Description>
			<Functions>
				<Check>isInteger</Check>
			</Functions>
		</Option>
		<Option id="buttonName" name="Button label" arity="ONE" isEvaluated="true">
			<Description>Specifies the label of the form submit button.</Description>
		</Option>
		<OptionComposite id="action" name="Search actions" arity="ZERO_OR_MANY" glue="##" isEvaluated="true">
			<Option id="label" name="Action's label">
				<Description>Specifies the label that will be displayed above your search form for this action.</Description>
				<Functions>
					<ContextMenu>I18N()</ContextMenu>
				</Functions>
			</Option>
			<Option id="name" name="Action's name">
				<Description>Specifies the name of a page or an absolute URL, corresponding to the form action. If empty, the form will be submitted to the current page.</Description>
				<Functions>
					<ContextMenu>Pages()</ContextMenu>
					<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
				</Functions>
			</Option>
		</OptionComposite>
		<Option id="focus" name="Auto focus" arity="ONE">
			<Description>Places the keyboard focus on the query input when the page is loaded.</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
		<Option id="advancedSearchEnabled" name="Enable advanced search" arity="ONE">
			<Description>Shows an 'advanced search' link next to the search form. Clicking brings down the advanced search options</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
		<Option id="keepRefinements" name="Enable search with refines" arity="ONE">
			<Description>Allows you to keep your refinements while searching.</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
			<Functions>
				<Display>ToggleDisplay({ valueToMatch: 'true', showOptions: ['keepRefinementsDefaultState'] })</Display>
			</Functions>
		</Option>
		<Option id="keepRefinementsDefaultState" name="Search with refines by default" arity="ZERO_OR_ONE">
			<Description>Specifies whether the 'search with refines' option should be enabled by default or not.</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
	</OptionsGroup>

	<OptionsGroup name="Suggest">
		<Description>The Suggest service cannot work for input of type "password" or "hidden".</Description>
		<Option id="enableSuggest" name="Enable suggest" arity="ONE">
			<Description>Enables the suggest service on the search field. You must then select a suggest service - previously defined in the Administration Console - from 'Suggest Name'.</Description>		
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
			<Functions>
				<Display>PARAMETER_doHide('false',['suggestNames', 'suggestApiAction', 'suggestApiConfig', 'suggestCustomSearchAPIs', 'suggestApiCommand'],[], true, false)</Display>
			</Functions>
		</Option>
		<Option id="suggestNames" name="Suggest Name" arity="MANY">
			<Description>Suggest service name.</Description>
			<Functions>
				<ContextMenu>SuggestNames('suggestApiAction')</ContextMenu>
				<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
			</Functions>
		</Option>
		<Option id="suggestApiAction" name="Action" arity="ONE">
			<Description>Specifies whether the suggest should use a simple service or a suggest dispatcher which varies depending on the query input. </Description>			
			<Values>
				<Value>dispatcher</Value>
				<Value>service</Value>
			</Values>
		</Option>
		<Option id="suggestApiConfig" name="Config" arity="ZERO_OR_ONE">
			<Description>
				<![CDATA[
					Indicates the name of the default Search API, for example, <code>sapi0</code>.
				]]>
			</Description>
			<Placeholder>sapi0</Placeholder>
			<Functions>
				<ContextMenu>ApiConfig()</ContextMenu>
				<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
				<Check>isSpecified('ONE', 'suggestCustomSearchAPIs')</Check>
			</Functions>
		</Option>
		<Option id="suggestCustomSearchAPIs" name="Search API URL" arity="ZERO_OR_MANY">
			<Description>Defines the URL that will be used by the Search API.</Description>
			<Placeholder>http://HOST:PORT/</Placeholder>
			<Functions>
				<Check>isSpecified('ONE', 'suggestApiConfig')</Check>
			</Functions>
		</Option>
		<Option id="suggestApiCommand" name="API command" arity="ONE">
			<Description>Specifies the suggest API command name that will be appended to the 'Search API URL'.</Description>
			<Placeholder>suggest</Placeholder>
			<Functions>
				<ContextMenu>ApiCommand()</ContextMenu>
				<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
			</Functions>
		</Option>
	</OptionsGroup>

	<OptionsGroup name="Instant Search">
		<Description>
			<![CDATA[
				Instant Search allows to update one or many widgets on each key pressed by the user, typically the result list, refinements... The request is sent with a trailing * to allow for prefix search.
				<br />
				Warning: This feature may generate a lot of requests, enabling cache is a good practice.
			]]>
		</Description>
		<Option id="expandQueryAfter" name="Expand query after n characters" arity="ZERO_OR_ONE">
			<Description>Expands the last searched term of the query after n characters with "*{w/=10}"</Description>
			<Functions>
				<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
				<Check>isInteger</Check>
			</Functions>
		</Option>
		<Option id="ajaxWUIDs" name="Update Widgets" arity="ZERO_OR_MANY">
			<Description>Refreshes the list of given widgets identified by a unique ID called WUID.</Description>
			<Functions>
				<ContextMenu>WIDGET_getWUIDS()</ContextMenu>
				<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
			</Functions>
		</Option>
		<Option id="instantSearchOnLoad" name="onLoad event" arity="ZERO_OR_ONE">
			<Description>Specifies the JavaScript code to be executed once the content is loaded.</Description>
			<Functions>
				<Display>SetType('code', 'js')</Display>
			</Functions>
		</Option>
	</OptionsGroup>

	<OptionsGroup name="Geolocation">
		<Option id="geoEnable" name="Enable geolocation" arity="ONE">
			<Description>
				<![CDATA[
					Injects the position of the user in the search form.<br />
					Warning: This option requires a browser that supports HTML5 Geolocation specification.<br />
					It will not work for older browsers and for Internet Explorer.
				]]>
			</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
			<Functions>
				<Display>PARAMETER_doHide('true', [], ['geoLatitude', 'geoLongitude', 'geoMaximumAge'], true, false)</Display>
			</Functions>
		</Option>
		<Option id="geoLatitude" name="Latitude parameter" arity="ONE">
			<Description>Parameter name associated with the user latitude.</Description>
			<Functions>
				<ContextMenu>PageParameters()</ContextMenu>
				<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
			</Functions>
		</Option>
		<Option id="geoLongitude" name="Longitude parameter" arity="ONE">
			<Description>Parameter name associated with the user longitude.</Description>
			<Functions>
				<ContextMenu>PageParameters()</ContextMenu>
				<ContextMenu>COMMON_emptyOnChange()</ContextMenu>
			</Functions>
		</Option>
		<Option id="geoMaximumAge" name="Maximum age" arity="ONE">
			<Description>Accepts a cached position whose age is no greater than the specified time in milliseconds. If 0 then the answer is not cached.</Description>
			<Functions>
				<Check>isInteger</Check>
			</Functions>
		</Option>
	</OptionsGroup>

	<DefaultValues>
		<DefaultValue name="inputName">q</DefaultValue>
		<DefaultValue name="inputSize">300</DefaultValue>
		<DefaultValue name="buttonName">${i18n['search']}</DefaultValue>
		<DefaultValue name="focus">true</DefaultValue>
		<DefaultValue name="advancedSearchEnabled">false</DefaultValue>
		<DefaultValue name="keepRefinements">false</DefaultValue>
		<DefaultValue name="keepRefinementsDefaultState">false</DefaultValue>

		<DefaultValue name="enableSuggest">false</DefaultValue>
		<DefaultValue name="suggestApiAction">service</DefaultValue>
		<DefaultValue name="suggestApiConfig">sapi0</DefaultValue>
		<DefaultValue name="suggestApiCommand">suggest</DefaultValue>

		<DefaultValue name="expandQueryAfter">3</DefaultValue>
		<DefaultValue name="instantSearchOnLoad">function() {}</DefaultValue>

		<DefaultValue name="geoEnable">false</DefaultValue>
		<DefaultValue name="geoLatitude">lat</DefaultValue>
		<DefaultValue name="geoLongitude">lon</DefaultValue>
		<DefaultValue name="geoMaximumAge">5000</DefaultValue>
	</DefaultValues>
</Widget>
