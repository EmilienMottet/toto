<?xml version="1.0" encoding='UTF-8'?>
<Widget name="Advanced Facet Table" group="Results Rendering" premium="true">

	<Description>Displays the categories of a given facet in a table that provides conditional formatting options to the end user.</Description>

	<StorageKeys>
		<StorageKey key="AdvancedTableConfigurations[]" resource="global" />
		<StorageKey optionId="storageKey" resource="user" />
	</StorageKeys>

	<Dependencies>
		<Widget name="advancedTable" />
	</Dependencies>

	<Preview>
		<![CDATA[
			<div style="margin: 5px auto;">
				<table style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px; width:200px;" align="center">
					<tr style="background:#F4F4F4;">
						<th style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;">Thumbnail</th>
						<th style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;">Column 1</th>
						<th style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;">Column 2</th>
					</tr>
					<tr>
						<td style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;"><img src="/resources/widgets/thumbnail/images/preview_thumbnail-unavailable.gif" width="60" /></td>
						<td style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;">Value A 1</td>
						<td style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;">Value A 2</td>
					</tr>
					<tr style="background-color:#D8FFED;">
						<td style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;"><img src="/resources/widgets/thumbnail/images/preview_thumbnail-unavailable.gif" width="60" /></td>
						<td style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;">Value B 1</td>
						<td style="border:1px solid #D4DBDE; border-collapse:collapse; padding:2px;">Value B 2</td>
					</tr>
				</table>
			</div>
		]]>
	</Preview>

	<SupportWidgetsId arity="ZERO" />
	<SupportFeedsId arity="MANY" />
	
	<OptionsGroup name="General">
		<Option id="title" name="Widget title" isEvaluated="true">
			<Description>Widget title. If blank, no name is displayed.</Description>
		</Option>
		<Option id="facetId" name="Facet" arity="ONE">
			<Description>Facet used to populate the table.</Description>
			<Functions>
				<ContextMenu>Facets()</ContextMenu>
			</Functions>
		</Option>
		<Option id="sortMode" name="Sort categories by" arity="ONE">
			<Description>
				<![CDATA[
					Sorts the categories using the selected method. Selecting anything but 'default' impacts performance.<br />
					<ul>
						<li>'default' requires no processing.</li>
						<li>'shuffle', 'desc*', 'score*', 'count*' and 'range*' impact performance on the client side.</li>
					</ul>
				]]>
			</Description>
			<Values>
				<Value>default</Value>
				<Value>description-asc</Value>
				<Value>description-desc</Value>
				<Value>score-asc</Value>
				<Value>score-desc</Value>
				<Value>count-asc</Value>
				<Value>count-desc</Value>
				<Value>range-asc</Value>
				<Value>range-desc</Value>
				<Value>shuffle</Value>
			</Values>
		</Option>
		<Option id="iterMode" name="Iteration mode" arity="ONE">
			<Description>
				<![CDATA[
					Determines what data is displayed:
					<ul>
						<li>'all' visits the first child of each node before processing its siblings,</li>
						<li>'leaves' iterates recursively, returning the end nodes,</li>
						<li>'flat' returns only the first level.</li>
					</ul>
				]]>
			</Description>
			<Values>
				<Value>all</Value>
				<Value>flat</Value>
				<Value>leaves</Value>
			</Values>
		</Option>
		<Option id="showRowNumber" name="Display the row number">
			<Description>Displays the row number in the first column.</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
		<Option id="draggableColumn" name="Moveable columns">
			<Description>Sets the table columns as moveable so that they can be reordered by the user on the Mashup UI.</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
		<Option id="enablePagination" name="Enable pagination">
			<Description>Enables pagination on the table. This is useful for long tables displaying many rows.</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
			<Functions>
				<Display>ToggleDisplay({valueToMatch:'false', hideOptions:['paginationSize']})</Display>
			</Functions>
		</Option>
		<Option id="paginationSize" name="Pagination size">
			<Description>Number of visible rows per page.</Description>
			<Functions>
				<Check>isInteger</Check>
			</Functions>
		</Option>
		<Option id="enableColumnFilter" name="Enable show/hide columns" arity="ONE">
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
		<Option id="enableFormatter" name="Enable conditional formatting" arity="ONE">
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
		<Option id="enableSave" name="Enable save feature" arity="ONE">
			<Description>If the user is logged, conditional formatting and/or column order will be saved in the mashup builder storage otherwise in a browser cookie.</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
		<Option id="enablePermalink" name="Enable permalink generation" arity="ONE">
			<Description>Permalink can be used to share customized table. (conditionnal formatting rules, column order...)</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
		<Option id="defaultConfigurationKey" name="Permalink storage key">
			<Description>Specifies the permalink storage key which identifies the default configuration. If blank, the end-user will not see the default configuration values in the table cells.</Description>
		</Option>
		<Option id="enableSort" name="Enable sort" isEvaluated="true">
			<Description>Enable sort</Description>
			<Values>
				<Value>false</Value>
				<Value>true</Value>
			</Values>
		</Option>
	</OptionsGroup>
	
	<OptionsGroup name="Columns">
		<OptionComposite id="columns" name="Column description" arity="ZERO_OR_MANY" glue="~~~~~">
			<Option id="id" name="Column identifier">
				<Description>Unique column identifier (required for formatting).</Description>
				<Placeholder>ID</Placeholder>
				<Functions>
					<Check>isEmpty</Check>
				</Functions>
			</Option>
			<Option id="name" isEvaluated="true" name="Column title">
				<Description>Specifies the column title.</Description>
				<Placeholder>Column title</Placeholder>
				<Functions>
					<Check>isEmpty</Check>
				</Functions>
			</Option>
			<Option id="type" name="Data type">
				<Description>Specifies the data type displayed in the column.</Description>
				<Placeholder>Data type</Placeholder>
				<Values>
					<Value></Value>
					<Value>number</Value>
					<Value>string</Value>
					<Value>boolean</Value>
					<Value>date</Value>
					<Value>url</Value>
				</Values>
				<Functions>
					<Check>isEmpty</Check>
					<Display>ToggleCompositeDisplay({ valueToMatch: ['number', 'string', 'boolean', 'url', 'date', 'numberDisplayedValue'], hideOptions: ['inDateFormatter', 'outDateFormatter', 'urlLabel'], showOptions: [], ifEquals:true })</Display>
					<Display>ToggleCompositeDisplay({ valueToMatch: 'date', hideOptions: [], showOptions: ['inDateFormatter', 'outDateFormatter'], ifEquals:true })</Display>
					<Display>ToggleCompositeDisplay({ valueToMatch: 'url', hideOptions: [], showOptions: ['urlLabel'], ifEquals:true })</Display>
					<Display>ToggleCompositeDisplay({ valueToMatch: 'number', hideOptions: [], showOptions: ['numberDisplayedValue'], ifEquals:true })</Display>
				</Functions>
			</Option>
			<Option id="value" name="Column value" isEvaluated="true">
				<Placeholder>Value</Placeholder>
				<Description>
					<![CDATA[
					<p>The column value can be defined using a MEL expression. Note that the value <b>must correspond</b> to the specified Data type:</p>
					<ul>
						<li><b>Number:</b> The value can be an integer or a double. For example, <i>${category.aggrs["avg_price"]}</i></li>
						<li><b>String:</b> Any string value including HTML. For example, <i>${category.description}</i> - Note that you can also display entries' categories <i>${entry.facets["author"].description}</i></li>
						<li><b>Boolean:</b> A boolean value (true or false) For example, <i>${category.count>100}</i></li>
						<li><b>Date:</b> A date value matching the <i>Date input format</i> below. Note that the displayed date can be formatted using <i>Date output format</i>.</li>
						<li><b>URl:</b> The value should be the URL (link).</li>
					</ul>
					]]>
				</Description>
				<Functions>
					<Check>isEmpty</Check>
					<ContextMenu>WIDGET_EvalCategory()</ContextMenu>
				</Functions>
			</Option>
			<Option id="inDateFormatter" name="Date input format" isEvaluated="true">
				<Placeholder>Format</Placeholder>
				<Description>
					<![CDATA[
						<p><i>Pattern format:</i></p>
						<table order="1" cellpadding="5" cellspacing="0" width="100%">
							<tbody>
								<tr><th width="15%">Code</th><th>Purpose </th><th>Sample</th></tr>
								<tr><td><p>G</p></td><td><p>The era designator</p></td><td><p>AD</p></td></tr>
								<tr><td><p>y</p></td><td><p>The year</p></td><td><p>2002</p></td></tr>
								<tr><td><p>M</p></td><td><p>The month</p></td><td><p>April &amp; 04</p></td></tr>
								<tr><td><p>d</p></td><td><p>The day of the month</p></td><td><p>20</p></td></tr>
								<tr><td><p>h</p></td><td><p>The hour(12-hour time)</p></td><td><p>12</p></td></tr>
								<tr><td><p>H</p></td><td><p>The hour(24-hour time)</p></td><td><p>0</p></td></tr>
								<tr><td><p>m</p></td><td><p>The minute</p></td><td><p>45</p></td></tr>
								<tr><td><p>s</p></td><td><p>The second</p></td><td><p>52</p></td></tr>
								<tr><td><p>S</p></td><td><p>The millisecond</p></td><td><p>970</p></td></tr>
								<tr><td><p>E</p></td><td><p>The day of the week</p></td><td><p>Tuesday</p></td></tr>
								<tr><td><p>D</p></td><td><p>The day of the year</p></td><td><p>180</p></td></tr>
								<tr><td><p>F</p></td><td><p>The day of the week in the month</p></td><td><p>2 (2nd Wed in month)</p></td></tr>
								<tr><td><p>w</p></td><td><p>The week in the year</p></td><td><p>27</p></td></tr>
								<tr><td><p>W</p></td><td><p>The week in the month</p></td><td><p>2</p></td></tr>
								<tr><td><p>a</p></td><td><p>The a.m./p.m. indicator</p></td><td><p>PM</p></td></tr>
								<tr><td><p>k</p></td><td><p>The hour(12-hour time)</p></td><td><p>24</p></td></tr>
								<tr><td><p>K</p></td><td><p>The hour(24-hour time)</p></td><td><p>0</p></td></tr>
								<tr><td><p>z</p></td><td><p>The time zone</p></td><td><p>Central Standard Time</p></td></tr>
								<tr><td><p>'</p></td><td>&nbsp;</td><td><p>The escape for text</p></td></tr>
								<tr><td><p>''</p></td><td>&nbsp;</td><td><p>The single quote</p></td></tr>
							</tbody>
						</table>
					]]>
				</Description>
				<Functions>
					<Check>isEmpty</Check>
				</Functions>
			</Option>
			<Option id="outDateFormatter" name="Date output format" isEvaluated="true">
				<Placeholder>Format</Placeholder>
				<Description>
					<![CDATA[
						<p><i>Pattern format:</i></p>
						<table order="1" cellpadding="5" cellspacing="0" width="100%">
							<tbody>
								<tr><th width="15%">Code</th><th>Purpose </th><th>Sample</th></tr>
								<tr><td><p>G</p></td><td><p>The era designator</p></td><td><p>AD</p></td></tr>
								<tr><td><p>y</p></td><td><p>The year</p></td><td><p>2002</p></td></tr>
								<tr><td><p>M</p></td><td><p>The month</p></td><td><p>April &amp; 04</p></td></tr>
								<tr><td><p>d</p></td><td><p>The day of the month</p></td><td><p>20</p></td></tr>
								<tr><td><p>h</p></td><td><p>The hour(12-hour time)</p></td><td><p>12</p></td></tr>
								<tr><td><p>H</p></td><td><p>The hour(24-hour time)</p></td><td><p>0</p></td></tr>
								<tr><td><p>m</p></td><td><p>The minute</p></td><td><p>45</p></td></tr>
								<tr><td><p>s</p></td><td><p>The second</p></td><td><p>52</p></td></tr>
								<tr><td><p>S</p></td><td><p>The millisecond</p></td><td><p>970</p></td></tr>
								<tr><td><p>E</p></td><td><p>The day of the week</p></td><td><p>Tuesday</p></td></tr>
								<tr><td><p>D</p></td><td><p>The day of the year</p></td><td><p>180</p></td></tr>
								<tr><td><p>F</p></td><td><p>The day of the week in the month</p></td><td><p>2 (2nd Wed in month)</p></td></tr>
								<tr><td><p>w</p></td><td><p>The week in the year</p></td><td><p>27</p></td></tr>
								<tr><td><p>W</p></td><td><p>The week in the month</p></td><td><p>2</p></td></tr>
								<tr><td><p>a</p></td><td><p>The a.m./p.m. indicator</p></td><td><p>PM</p></td></tr>
								<tr><td><p>k</p></td><td><p>The hour(12-hour time)</p></td><td><p>24</p></td></tr>
								<tr><td><p>K</p></td><td><p>The hour(24-hour time)</p></td><td><p>0</p></td></tr>
								<tr><td><p>z</p></td><td><p>The time zone</p></td><td><p>Central Standard Time</p></td></tr>
								<tr><td><p>'</p></td><td>&nbsp;</td><td><p>The escape for text</p></td></tr>
								<tr><td><p>''</p></td><td>&nbsp;</td><td><p>The single quote</p></td></tr>
							</tbody>
						</table>
					]]>
				</Description>
				<Functions>
					<Check>isEmpty</Check>
				</Functions>
			</Option>
			<Option id="urlLabel" name="Url label" isEvaluated="true">
				<Placeholder>Label</Placeholder>
				<Description>You can specify a custom label for the URL or use a MEL expression.
				For example, ${category.description}.
				You can add 'http://' prefix if not specified in the data.</Description>
				<Functions>
					<Check>isEmpty</Check>
				</Functions>
			</Option>
			<Option id="numberDisplayedValue" name="Displayed value" isEvaluated="true">
				<Placeholder>Format</Placeholder>
				<Description>MEL expression representing the value. If empty, the value will be dislayed.</Description>
			</Option>
			<Functions>
				<Display>SetDisplayMode('list')</Display>
			</Functions>
		</OptionComposite>
	</OptionsGroup>
	
	<OptionsGroup name="Storage">
		<Option id="storageKey" name="Storage key" arity="ZERO_OR_ONE">
			<Description>Specifies the key name for the local storage. It is used when the user is logged in to store his formatting preferences. Widgets with the same storage key will share the preferences.</Description>
		</Option>
	</OptionsGroup>
	
	<OptionsGroup name="Advanced">
		<Option id="noResultsJspPathHit" name="Results Rendering" arity="ONE">
			<Description>If there are no results, the widget is either hidden using a trigger, or a message is displayed using the content of a JSP file.</Description>
			<Functions>
				<Check>isJspPath</Check>
			</Functions>
		</Option>
	</OptionsGroup>

	<DefaultValues>
		<DefaultValue name="columns">description~~~~~Description~~~~~string~~~~~${category.description}~~~~~MM/dd/yyyy HH:mm:ss~~~~~MM/dd/yyyy HH:mm:ss~~~~~</DefaultValue>
		<DefaultValue name="columns">count~~~~~Count~~~~~number~~~~~${category.count}~~~~~MM/dd/yyyy HH:mm:ss~~~~~MM/dd/yyyy HH:mm:ss~~~~~</DefaultValue>
				
		<DefaultValue name="noResultsJspPathHit">/WEB-INF/jsp/commons/noFacets.jsp</DefaultValue>
		
		<DefaultValue name="enablePagination">false</DefaultValue>
		<DefaultValue name="paginationSize">10</DefaultValue>
		
		<DefaultValue name="enableColumnFilter">true</DefaultValue>
		<DefaultValue name="enableFormatter">true</DefaultValue>
		<DefaultValue name="enableSave">true</DefaultValue>
		<DefaultValue name="enablePermalink">true</DefaultValue>
		<DefaultValue name="enableSort">true</DefaultValue>
		
		<DefaultValue name="storageKey">AdvancedFacetTableConfiguration</DefaultValue>
	</DefaultValues>
</Widget>

